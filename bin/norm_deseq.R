library('DESeq2')
rawCountTable <- read.table('gene_raw_read', sep='\t', quote='', comment.char='', colClasses=c(rep('character',1), rep('numeric',14)))
countTable <- round(rawCountTable[,2:length(names(rawCountTable))])
libs <- c('TSB_OD_0.2','TSB_OD_0.5','TSB_OD_1','TSB_t0','TSB_t1','TSB_t2','TSB_ON','pMEM_OD_0.2','pMEM_OD_0.5','pMEM_OD_1','pMEM_t0','pMEM_t1','pMEM_t2','pMEM_ON')
conds <- c('TSB_OD_0.2.fa','TSB_OD_0.5.fa','TSB_OD_1.fa','TSB_t0.fa','TSB_t1.fa','TSB_t2.fa','TSB_ON.fa','pMEM_OD_0.2.fa','pMEM_OD_0.5.fa','pMEM_OD_1.fa','pMEM_t0.fa','pMEM_t1.fa','pMEM_t2.fa','pMEM_ON.fa')
samples <- data.frame(row.names=libs, condition=conds, lib=libs)
colnames(countTable) <- NULL
dds <- DESeqDataSetFromMatrix(countData=countTable, colData=samples, design=~condition) ### sometimes it need to run colnames(countTable) <- NULL
#dds <- estimateSizeFactors(dds)
#data <- counts(dds, normalized=TRUE)
#write.table(data, file='deseq_count', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
dds <- DESeq(dds)
comp0 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'TSB_OD_0.5.fa'))
write.table(comp0, file='output/fold_change/TSB_OD_0.2_vs_TSB_OD_0.5.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp1 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'TSB_OD_1.fa'))
write.table(comp1, file='output/fold_change/TSB_OD_0.2_vs_TSB_OD_1.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp2 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'TSB_t0.fa'))
write.table(comp2, file='output/fold_change/TSB_OD_0.2_vs_TSB_t0.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp3 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'TSB_t1.fa'))
write.table(comp3, file='output/fold_change/TSB_OD_0.2_vs_TSB_t1.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp4 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'TSB_t2.fa'))
write.table(comp4, file='output/fold_change/TSB_OD_0.2_vs_TSB_t2.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp5 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'TSB_ON.fa'))
write.table(comp5, file='output/fold_change/TSB_OD_0.2_vs_TSB_ON.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp6 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'pMEM_OD_0.2.fa'))
write.table(comp6, file='output/fold_change/TSB_OD_0.2_vs_pMEM_OD_0.2.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp7 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'pMEM_OD_0.5.fa'))
write.table(comp7, file='output/fold_change/TSB_OD_0.2_vs_pMEM_OD_0.5.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp8 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'pMEM_OD_1.fa'))
write.table(comp8, file='output/fold_change/TSB_OD_0.2_vs_pMEM_OD_1.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp9 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'pMEM_t0.fa'))
write.table(comp9, file='output/fold_change/TSB_OD_0.2_vs_pMEM_t0.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp10 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'pMEM_t1.fa'))
write.table(comp10, file='output/fold_change/TSB_OD_0.2_vs_pMEM_t1.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp11 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'pMEM_t2.fa'))
write.table(comp11, file='output/fold_change/TSB_OD_0.2_vs_pMEM_t2.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)
comp12 <- results(dds, contrast=c('condition','TSB_OD_0.2.fa', 'pMEM_ON.fa'))
write.table(comp12, file='output/fold_change/TSB_OD_0.2_vs_pMEM_ON.csv', quote=FALSE, sep='\t', row.name=rawCountTable$V1)


#png(filename="TSB_OD_0.2_vs_TSB_OD_0.5.png")
#plotMA(comp0,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_TSB_OD_1.png")
#plotMA(comp1,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_TSB_t0.png")
#plotMA(comp2,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_TSB_t1.png")
#plotMA(comp3,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_TSB_t2.png")
#plotMA(comp4,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_TSB_ON.png")
#plotMA(comp5,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_pMEM_OD_0.2.png")
#plotMA(comp6,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_pMEM_OD_0.5.png")
#plotMA(comp7,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_pMEM_OD_1.png")
#plotMA(comp8,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_pMEM_t0.png")
#plotMA(comp9,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_pMEM_t1.png")
#plotMA(comp10,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_pMEM_t2.png")
#plotMA(comp11,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="TSB_OD_0.2_vs_pMEM_ON.png")
#plotMA(comp12,ylim=c(-2,2),main='DESeq2')
#dev.off()
#png(filename="deseq.png")
#plotMA(dds,ylim=c(-2,2),main='DESeq2')
#dev.off()
